[2025-02-05T00:27:46.073+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-02-05T00:27:46.092+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: dag_dbt-model_credit_fraud.model_credit_fraud.ad_hoc_rnk_amount_run manual__2025-02-05T00:00:00+00:00 [queued]>
[2025-02-05T00:27:46.104+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: dag_dbt-model_credit_fraud.model_credit_fraud.ad_hoc_rnk_amount_run manual__2025-02-05T00:00:00+00:00 [queued]>
[2025-02-05T00:27:46.105+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-02-05T00:27:46.122+0000] {taskinstance.py:2330} INFO - Executing <Task(DbtRunLocalOperator): model_credit_fraud.ad_hoc_rnk_amount_run> on 2025-02-05 00:00:00+00:00
[2025-02-05T00:27:46.128+0000] {standard_task_runner.py:63} INFO - Started process 1660 to run task
[2025-02-05T00:27:46.133+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'dag_dbt-model_credit_fraud', 'model_credit_fraud.ad_hoc_rnk_amount_run', 'manual__2025-02-05T00:00:00+00:00', '--job-id', '22', '--raw', '--subdir', 'DAGS_FOLDER/dag_dbt-model_fraud_credit.py', '--cfg-path', '/tmp/tmptk7yw2e7']
[2025-02-05T00:27:46.135+0000] {standard_task_runner.py:91} INFO - Job 22: Subtask model_credit_fraud.ad_hoc_rnk_amount_run
[2025-02-05T00:27:46.201+0000] {task_command.py:426} INFO - Running <TaskInstance: dag_dbt-model_credit_fraud.model_credit_fraud.ad_hoc_rnk_amount_run manual__2025-02-05T00:00:00+00:00 [running]> on host eb20c43aeeb4
[2025-02-05T00:27:46.333+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='dag_dbt-model_credit_fraud' AIRFLOW_CTX_TASK_ID='model_credit_fraud.ad_hoc_rnk_amount_run' AIRFLOW_CTX_EXECUTION_DATE='2025-02-05T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-02-05T00:00:00+00:00'
[2025-02-05T00:27:46.336+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-02-05T00:27:48.373+0000] {local.py:220} INFO - dbtRunner is available. Using dbtRunner for invoking dbt.
[2025-02-05T00:27:48.375+0000] {local.py:436} INFO - Cloning project to writable temp directory /tmp/tmppcpixnny from /usr/local/airflow/dags/dbt/localiza_dw
[2025-02-05T00:27:48.378+0000] {local.py:447} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/dag_dbt-model_credit_fraud__model_credit_fraud/target/partial_parse.msgpack
[2025-02-05T00:27:48.383+0000] {config.py:348} INFO - Profile caching is enable.
[2025-02-05T00:27:48.390+0000] {base.py:84} INFO - Using connection ID '***' for task execution.
[2025-02-05T00:27:48.391+0000] {config.py:328} INFO - Profile found in cache using profile: /tmp/cosmos/profile/bdc35343eb23031ee554202b16407e794194afcc614f7ea62bc658c63495a211/profiles.yml.
[2025-02-05T00:27:48.391+0000] {local.py:408} INFO - Trying to run dbtRunner with:
 ['run', '--models', 'ad_hoc_rnk_amount', '--project-dir', '/tmp/tmppcpixnny', '--profiles-dir', '/tmp/cosmos/profile/bdc35343eb23031ee554202b16407e794194afcc614f7ea62bc658c63495a211', '--profile', '***', '--target', 'prod']
 in /tmp/tmppcpixnny
[2025-02-05T00:27:48.405+0000] {logging_mixin.py:188} INFO - 00:27:48  Running with dbt=1.6.1
[2025-02-05T00:27:48.486+0000] {logging_mixin.py:188} INFO - 00:27:48  Registered adapter: postgres=1.6.1
[2025-02-05T00:27:48.663+0000] {logging_mixin.py:188} INFO - 00:27:48  Found 3 models, 1 snapshot, 5 tests, 1 source, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[2025-02-05T00:27:48.665+0000] {logging_mixin.py:188} INFO - 00:27:48
[2025-02-05T00:27:48.717+0000] {logging_mixin.py:188} INFO - 00:27:48  Concurrency: 1 threads (target='prod')
[2025-02-05T00:27:48.718+0000] {logging_mixin.py:188} INFO - 00:27:48
[2025-02-05T00:27:48.721+0000] {logging_mixin.py:188} INFO - 00:27:48  1 of 1 START sql table model dm_credit_operations.ad_hoc_rnk_amount ............ [RUN]
[2025-02-05T00:27:58.237+0000] {logging_mixin.py:188} INFO - 00:27:58  1 of 1 OK created sql table model dm_credit_operations.ad_hoc_rnk_amount ....... [SELECT 3 in 9.51s]
[2025-02-05T00:27:58.249+0000] {logging_mixin.py:188} INFO - 00:27:58
[2025-02-05T00:27:58.250+0000] {logging_mixin.py:188} INFO - 00:27:58  Finished running 1 table model in 0 hours 0 minutes and 9.58 seconds (9.58s).
[2025-02-05T00:27:58.287+0000] {logging_mixin.py:188} INFO - 00:27:58
[2025-02-05T00:27:58.288+0000] {logging_mixin.py:188} INFO - 00:27:58  Completed successfully
[2025-02-05T00:27:58.289+0000] {logging_mixin.py:188} INFO - 00:27:58
[2025-02-05T00:27:58.290+0000] {logging_mixin.py:188} INFO - 00:27:58  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[2025-02-05T00:27:59.039+0000] {local.py:138} WARNING - Artifact schema version: https://schemas.getdbt.com/dbt/manifest/v10.json is above dbt-ol supported version 7. This might cause errors.
[2025-02-05T00:27:59.064+0000] {local.py:494} INFO - Inlets: [Dataset(uri='postgres://postgres-db:5432/localiza_dw.dm_credit_operations.stg_credit_fraud', extra=None)]
[2025-02-05T00:27:59.066+0000] {local.py:495} INFO - Outlets: [Dataset(uri='postgres://postgres-db:5432/localiza_dw.dm_credit_operations.ad_hoc_rnk_amount', extra=None)]
[2025-02-05T00:27:59.067+0000] {local.py:595} INFO - Assigning inlets/outlets without DatasetAlias
[2025-02-05T00:27:59.068+0000] {dag.py:3096} INFO - Sync 1 DAGs
[2025-02-05T00:27:59.079+0000] {dag.py:3954} INFO - Setting next_dagrun for dag_dbt-model_credit_fraud to None, run_after=None
[2025-02-05T00:27:59.108+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-02-05T00:27:59.128+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=dag_dbt-model_credit_fraud, task_id=model_credit_fraud.ad_hoc_rnk_amount_run, run_id=manual__2025-02-05T00:00:00+00:00, execution_date=20250205T000000, start_date=20250205T002746, end_date=20250205T002759
[2025-02-05T00:27:59.185+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-02-05T00:27:59.206+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-05T00:27:59.209+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-02-05T14:40:25.975+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-02-05T14:40:25.992+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: dag_dbt-model_credit_fraud.model_credit_fraud.ad_hoc_rnk_amount_run manual__2025-02-05T00:00:00+00:00 [queued]>
[2025-02-05T14:40:26.003+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: dag_dbt-model_credit_fraud.model_credit_fraud.ad_hoc_rnk_amount_run manual__2025-02-05T00:00:00+00:00 [queued]>
[2025-02-05T14:40:26.004+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-02-05T14:40:26.018+0000] {taskinstance.py:2330} INFO - Executing <Task(DbtRunLocalOperator): model_credit_fraud.ad_hoc_rnk_amount_run> on 2025-02-05 00:00:00+00:00
[2025-02-05T14:40:26.025+0000] {standard_task_runner.py:63} INFO - Started process 481 to run task
[2025-02-05T14:40:26.028+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'dag_dbt-model_credit_fraud', 'model_credit_fraud.ad_hoc_rnk_amount_run', 'manual__2025-02-05T00:00:00+00:00', '--job-id', '22', '--raw', '--subdir', 'DAGS_FOLDER/dag_dbt-model_fraud_credit.py', '--cfg-path', '/tmp/tmp4syh40a9']
[2025-02-05T14:40:26.030+0000] {standard_task_runner.py:91} INFO - Job 22: Subtask model_credit_fraud.ad_hoc_rnk_amount_run
[2025-02-05T14:40:26.081+0000] {task_command.py:426} INFO - Running <TaskInstance: dag_dbt-model_credit_fraud.model_credit_fraud.ad_hoc_rnk_amount_run manual__2025-02-05T00:00:00+00:00 [running]> on host eb17fa5f9c23
[2025-02-05T14:40:26.170+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='dag_dbt-model_credit_fraud' AIRFLOW_CTX_TASK_ID='model_credit_fraud.ad_hoc_rnk_amount_run' AIRFLOW_CTX_EXECUTION_DATE='2025-02-05T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-02-05T00:00:00+00:00'
[2025-02-05T14:40:26.173+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-02-05T14:40:29.482+0000] {local.py:220} INFO - dbtRunner is available. Using dbtRunner for invoking dbt.
[2025-02-05T14:40:29.484+0000] {local.py:436} INFO - Cloning project to writable temp directory /tmp/tmp3z1n0lzh from /usr/local/airflow/dags/dbt/localiza_dw
[2025-02-05T14:40:29.496+0000] {local.py:447} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/dag_dbt-model_credit_fraud__model_credit_fraud/target/partial_parse.msgpack
[2025-02-05T14:40:29.504+0000] {config.py:348} INFO - Profile caching is enable.
[2025-02-05T14:40:29.515+0000] {base.py:84} INFO - Using connection ID '***' for task execution.
[2025-02-05T14:40:29.517+0000] {config.py:328} INFO - Profile found in cache using profile: /tmp/cosmos/profile/bdc35343eb23031ee554202b16407e794194afcc614f7ea62bc658c63495a211/profiles.yml.
[2025-02-05T14:40:29.518+0000] {local.py:408} INFO - Trying to run dbtRunner with:
 ['run', '--models', 'ad_hoc_rnk_amount', '--project-dir', '/tmp/tmp3z1n0lzh', '--profiles-dir', '/tmp/cosmos/profile/bdc35343eb23031ee554202b16407e794194afcc614f7ea62bc658c63495a211', '--profile', '***', '--target', 'prod']
 in /tmp/tmp3z1n0lzh
[2025-02-05T14:40:29.541+0000] {logging_mixin.py:188} INFO - 14:40:29  Running with dbt=1.6.1
[2025-02-05T14:40:29.698+0000] {logging_mixin.py:188} INFO - 14:40:29  Registered adapter: postgres=1.6.1
[2025-02-05T14:40:30.452+0000] {logging_mixin.py:188} INFO - 14:40:30  Found 4 models, 1 snapshot, 4 seeds, 5 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[2025-02-05T14:40:30.456+0000] {logging_mixin.py:188} INFO - 14:40:30
[2025-02-05T14:40:30.542+0000] {logging_mixin.py:188} INFO - 14:40:30  Concurrency: 1 threads (target='prod')
[2025-02-05T14:40:30.543+0000] {logging_mixin.py:188} INFO - 14:40:30
[2025-02-05T14:40:30.550+0000] {logging_mixin.py:188} INFO - 14:40:30  1 of 1 START sql table model dm_credit_operations.ad_hoc_rnk_amount ............ [RUN]
[2025-02-05T14:40:30.629+0000] {logging_mixin.py:188} INFO - 14:40:30  1 of 1 ERROR creating sql table model dm_credit_operations.ad_hoc_rnk_amount ... [ERROR in 0.08s]
[2025-02-05T14:40:30.646+0000] {logging_mixin.py:188} INFO - 14:40:30
[2025-02-05T14:40:30.647+0000] {logging_mixin.py:188} INFO - 14:40:30  Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[2025-02-05T14:40:30.658+0000] {logging_mixin.py:188} INFO - 14:40:30
[2025-02-05T14:40:30.659+0000] {logging_mixin.py:188} INFO - 14:40:30  Completed with 1 error and 0 warnings:
[2025-02-05T14:40:30.660+0000] {logging_mixin.py:188} INFO - 14:40:30
[2025-02-05T14:40:30.662+0000] {logging_mixin.py:188} INFO - 14:40:30  Database Error in model ad_hoc_rnk_amount (models/marts/credit_fraud/ad_hoc_rnk_amount.sql)
[2025-02-05T14:40:30.662+0000] {logging_mixin.py:188} INFO - 14:40:30    relation "dm_credit_operations.stg_credit_fraud" does not exist
[2025-02-05T14:40:30.664+0000] {logging_mixin.py:188} INFO - 14:40:30    LINE 19:         "***"."dm_credit_operations"."stg_credit_fra...
[2025-02-05T14:40:30.665+0000] {logging_mixin.py:188} INFO - 14:40:30                     ^
[2025-02-05T14:40:30.667+0000] {logging_mixin.py:188} INFO - 14:40:30    compiled Code at target/run/***/models/marts/credit_fraud/ad_hoc_rnk_amount.sql
[2025-02-05T14:40:30.668+0000] {logging_mixin.py:188} INFO - 14:40:30
[2025-02-05T14:40:30.669+0000] {logging_mixin.py:188} INFO - 14:40:30  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[2025-02-05T14:40:33.576+0000] {local.py:138} WARNING - Artifact schema version: https://schemas.getdbt.com/dbt/manifest/v10.json is above dbt-ol supported version 7. This might cause errors.
[2025-02-05T14:40:33.580+0000] {local.py:494} INFO - Inlets: []
[2025-02-05T14:40:33.580+0000] {local.py:495} INFO - Outlets: []
[2025-02-05T14:40:33.581+0000] {local.py:595} INFO - Assigning inlets/outlets without DatasetAlias
[2025-02-05T14:40:33.582+0000] {dag.py:3096} INFO - Sync 1 DAGs
[2025-02-05T14:40:33.597+0000] {dag.py:3954} INFO - Setting next_dagrun for dag_dbt-model_credit_fraud to None, run_after=None
[2025-02-05T14:40:33.633+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-02-05T14:40:33.641+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/cosmos/operators/base.py", line 268, in execute
    self.build_and_run_cmd(context=context, cmd_flags=self.add_cmd_flags())
  File "/usr/local/lib/python3.11/site-packages/cosmos/operators/local.py", line 654, in build_and_run_cmd
    result = self.run_command(cmd=dbt_cmd, env=env, context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/cosmos/operators/local.py", line 509, in run_command
    self.handle_exception(result)
  File "/usr/local/lib/python3.11/site-packages/cosmos/operators/local.py", line 237, in handle_exception_dbt_runner
    raise AirflowException(f"dbt invocation completed with errors: {error_message}")
airflow.exceptions.AirflowException: dbt invocation completed with errors: ad_hoc_rnk_amount: Database Error in model ad_hoc_rnk_amount (models/marts/credit_fraud/ad_hoc_rnk_amount.sql)
  relation "dm_credit_operations.stg_credit_fraud" does not exist
  LINE 19:         "***"."dm_credit_operations"."stg_credit_fra...
                   ^
  compiled Code at target/run/***/models/marts/credit_fraud/ad_hoc_rnk_amount.sql
[2025-02-05T14:40:33.645+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=dag_dbt-model_credit_fraud, task_id=model_credit_fraud.ad_hoc_rnk_amount_run, run_id=manual__2025-02-05T00:00:00+00:00, execution_date=20250205T000000, start_date=20250205T144025, end_date=20250205T144033
[2025-02-05T14:40:33.658+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 22 for task model_credit_fraud.ad_hoc_rnk_amount_run (dbt invocation completed with errors: ad_hoc_rnk_amount: Database Error in model ad_hoc_rnk_amount (models/marts/credit_fraud/ad_hoc_rnk_amount.sql)
  relation "dm_credit_operations.stg_credit_fraud" does not exist
  LINE 19:         "***"."dm_credit_operations"."stg_credit_fra...
                   ^
  compiled Code at target/run/***/models/marts/credit_fraud/ad_hoc_rnk_amount.sql; 481)
[2025-02-05T14:40:33.679+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-02-05T14:40:33.700+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-05T14:40:33.704+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
